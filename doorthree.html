<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê³ í–¥ê³¼ ìœ ì‚¬í•œ ê³µê°„</title>
<link href="https://fonts.googleapis.com/css2?family=Orbit:wght@400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  width:100vw;height:100vh;
  overflow:hidden;
  background:url('newlibrary.png') center/cover no-repeat;
  font-family:"Orbit", sans-serif;
  cursor:none;
  position:relative;
  transition:background 1s ease;
}

/* ìŒì•… í”Œë ˆì´ì–´ - ìœˆë„ìš° ì°½ ìŠ¤íƒ€ì¼ */
#music-player{
  position:fixed;
  top:120px;
  right:100px;
  z-index:200;
  background:#C0C0C0;
  border:3px outset #C0C0C0;
  padding:0;
  box-shadow:inset 1px 1px 0px #000, inset -1px -1px 0px #fff, 2px 2px 4px rgba(0,0,0,0.3);
  font-family:"MS Sans Serif", "Segoe UI", sans-serif;
  min-width:200px;
}

#music-player-title{
  background:#000080;
  color:#fff;
  font-size:0.75rem;
  margin:0;
  padding:3px 6px;
  text-align:left;
  font-weight:normal;
  border-bottom:2px solid #000;
}

#music-player-content{
  padding:8px;
  display:flex;
  align-items:center;
  gap:8px;
}

#music-toggle{
  background:#C0C0C0;
  border:2px outset #C0C0C0;
  color:#000;
  padding:3px 12px;
  cursor:pointer;
  font-size:0.7rem;
  font-family:"MS Sans Serif", "Segoe UI", sans-serif;
  min-width:50px;
}

#music-toggle:active{
  border:2px inset #C0C0C0;
}

#volume-control{
  display:flex;
  align-items:center;
  gap:5px;
  font-size:0.7rem;
  color:#000;
}

#volume-slider{
  width:70px;
  height:4px;
  background:#C0C0C0;
  border:1px inset #C0C0C0;
  outline:none;
  cursor:pointer;
}

#volume-slider::-webkit-slider-thumb{
  appearance:none;
  width:10px;
  height:10px;
  background:#C0C0C0;
  border:1px outset #C0C0C0;
  cursor:pointer;
}

#volume-slider::-moz-range-thumb{
  width:10px;
  height:10px;
  background:#C0C0C0;
  border:1px outset #C0C0C0;
  cursor:pointer;
}

/* ì±•í„° */
#chapter-label{
  position:fixed;
  top:30px;
  left:50%;
  transform:translateX(-50%);
  color:white;
  font-size:1.2rem;
  font-weight:bold;
  text-shadow:0 2px 10px rgba(0,0,0,0.5);
  z-index:200;
}

/* CRT FRAME */
#web-frame{
  position:fixed; inset:0;
  width:100vw; height:100vh;
  object-fit:cover;
  z-index:9999;
  pointer-events:none;
}

/* ë…¸ì´ì¦ˆ */
#window-noise{
  position:fixed; inset:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity:0.15;
  pointer-events:none;
  z-index:10000;
  mix-blend-mode:overlay;
  animation:noiseFlicker 0.1s infinite;
}
@keyframes noiseFlicker{
  0%,100%{opacity:0.1;}
  50%{opacity:0.2;}
}

/* ìŠ¤ìº”ë¼ì¸ */
#scanlines{
  position:fixed; inset:0;
  background:repeating-linear-gradient(
    0deg, transparent 0px, transparent 2px,
    rgba(0,0,0,0.1) 2px, rgba(0,0,0,0.1) 4px
  );
  pointer-events:none;
  z-index:10001;
}

#blue-filter{
  position:fixed; inset:0;
  background:rgba(100,150,255,0.25);
  z-index:1;
  pointer-events:none;
  mix-blend-mode:multiply;
}

/* hometown.png ì „ì²´ í™”ë©´ ì˜¤ë²„ë ˆì´ */
#hometown-fullscreen{
  position:fixed;
  inset:0;
  background:url('hometown.png') center/cover no-repeat;
  z-index:50;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.3s;
}
#hometown-fullscreen.show{
  opacity:1;
}
#hometown-fullscreen.flicker{
  animation:flickerEffect 0.5s;
}
@keyframes flickerEffect{
  0%,100%{opacity:1;}
  25%{opacity:0.3;}
  50%{opacity:1;}
  75%{opacity:0.5;}
}

/* ìŠ¤í”¼ì»¤ ë¼ë²¨ */
#speaker-label{
  position:fixed;
  bottom:210px;
  left:50%;
  transform:translateX(-50%);
  margin-left:-280px;
  background:rgba(0,0,100,0.85);
  color:white;
  padding:8px 16px;
  border-radius:8px;
  font-size:0.9rem;
  font-weight:bold;
  text-transform:uppercase;
  z-index:100;
  pointer-events:none;
  font-family:"Orbit", sans-serif;
  opacity:0;
  transition:opacity 0.3s;
}
#speaker-label.show{
  opacity:1;
}

/* ìë§‰ë°” */
#subtitle-box{
  position:fixed;
  bottom:90px;
  left:50%;
  transform:translateX(-50%);
  width:600px;
  max-width:90%;
  background:rgba(0,0,0,0.6);
  padding:20px 30px;
  z-index:100;
  cursor:pointer;
  transition:background 0.3s, opacity 0.3s;
  min-height:80px;
  display:flex;
  align-items:center;
  border-radius:10px;
  backdrop-filter:blur(5px);
  opacity:0;
}
#subtitle-box.show{
  opacity:1;
}
#subtitle-box:hover{
  background:rgba(0,0,0,0.75);
}

/* ìë§‰ í…ìŠ¤íŠ¸ */
#subtitle-text{
  color:white;
  font-size:1.1rem;
  line-height:1.6;
  font-family:"Orbit", sans-serif;
  width:100%;
  max-width:90%;
}

/* íƒ€ì´í•‘ ì»¤ì„œ */
#typing-cursor{
  display:inline-block;
  width:2px;
  height:1.2em;
  background:white;
  margin-left:4px;
  animation:blinkCursor 1s infinite;
  vertical-align:middle;
}

@keyframes blinkCursor{
  0%,50%{opacity:1;}
  51%,100%{opacity:0;}
}

/* ì¥ë©´ */
#library-scene{
  position:fixed; inset:0;
  z-index:0;
  opacity:0;
  pointer-events:none;
  transition:opacity 1s;
}
#library-scene.show{
  opacity:1;
  pointer-events:auto;
}

/* ê°ì²´ë“¤ */
.obj{
  position:absolute;
  cursor:pointer;
  transition:filter .3s;
  opacity:0;
  pointer-events:none;
}
.obj.show{
  opacity:1;
  pointer-events:auto;
}
.obj:hover{ filter:brightness(1.2); }

#hometown-overlay{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:rgba(0,0,0,0.6);
  opacity:0; pointer-events:none;
  z-index:999;
  transition:opacity .4s;
}
#hometown-overlay.show{
  opacity:1; pointer-events:auto;
}
#hometown-image{
  max-width:60%; max-height:70%;
  border:5px solid white;
  box-shadow:0 0 40px rgba(0,0,0,0.5);
}

/* ì•ˆë‚´ */
#hint{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  color:white;
  font-size:1.1rem;
  z-index:10;
  background:rgba(0,0,0,0.75);
  padding:15px 30px;
  border-radius:20px;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.5s;
  text-align:center;
}
#hint.show{
  opacity:1;
  pointer-events:auto;
}
#hint.bottom-center{
  top:auto;
  bottom:100px;
  transform:translateX(-50%);
}

/* ì»¤ì„œ */
#cursor-dot{
  position:fixed;
  width:14px;height:14px;
  border:2px solid rgba(255,255,255,0.9);
  border-radius:50%;
  transform:translate(-50%,-50%);
  pointer-events:none;
  z-index:9999;
}

/* ì»¤ì„œ ë”°ë¼ì˜¤ëŠ” ì§‘ ì´ë¯¸ì§€ */
#home-container{
  position:fixed;
  top:0;
  left:0;
  width:100vw;
  height:100vh;
  pointer-events:none;
  z-index:500;
}

.home{
  position:absolute;
  width:60px;
  height:auto;
  opacity:0.7;
  animation:floatHome 1s ease-out forwards;
  pointer-events:none;
}

@keyframes floatHome{
  0%{
    opacity:0.7;
    transform:translate(0,0) scale(1);
  }
  100%{
    opacity:0;
    transform:translate(0,-30px) scale(0.8);
  }
}

/* íŒì—… */
#popup{
  position:fixed;
  bottom:100px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0, 0, 255, 0.6);
  color:white;
  padding:18px 26px;
  border-radius:10px;
  font-size:1.1rem;
  z-index:850;
  display:none;
  backdrop-filter:blur(4px);
  border:1px solid rgba(255,255,255,0.3);
  text-align:center;
}

#popup-image{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:40%;
  max-width:500px;
  border-radius:10px;
  display:none;
  z-index:850;
}

/* í•«ìŠ¤íŒŸ ê³µí†µ */
.hotspot{
  position:absolute;
  cursor:pointer;
  background:rgba(0, 4, 255, 0);
  pointer-events:auto;
  z-index:600;
}

/* í•«ìŠ¤íŒŸ ìœ„ì¹˜ */
#hot-wall{top:5%;left:5%;width:30%;height:25%;} /* ë²½ì§€ (ìƒë‹¨ ì™¼ìª½) */
#hot-tree{top:35%;left:40%;width:20%;height:25%;} /* ë‚˜ë¬´ (ì¤‘ì•™ì—ì„œ ì‚´ì§ ìœ„) */
#hot-shelf{top:40%;right:15%;width:25%;height:30%;} /* ì±…ì¥ (ì¤‘ì•™ë¶€ ì˜¤ë¥¸ìª½) */
#hot-book{bottom:10%;left:5%;width:30%;height:25%;} /* ì±… (í•˜ë‹¨ ì™¼ìª½) */

/* ë¬¼ìŒí‘œ ë²„íŠ¼ - ìœˆë„ìš° í”„ë ˆì„ ìš°ì¸¡ ìƒë‹¨ */
#help-button{
  position:fixed;
  top:8px;
  right:8px;
  width:48px;
  height:48px;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#0066cc;
  color:white;
  font-size:1.8rem;
  font-weight:bold;
  cursor:pointer;
  opacity:0;
  visibility:hidden;
  transition:opacity 0.5s, visibility 0.5s;
  z-index:10002;
  border:1px solid #004499;
}
#help-button.show{
  opacity:1;
  visibility:visible;
}
#help-button:hover{
  background:#0088ff;
}

/* ê³ í–¥ ë¹„êµ ì˜¤ë²„ë ˆì´ */
#hometown-comparison{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.9);
  z-index:900;
  display:none;
  flex-direction:row;
  align-items:center;
  justify-content:center;
  gap:40px;
  padding:40px;
}
#hometown-comparison.show{
  display:flex;
}
#hometown-comparison .comparison-image{
  max-width:45%;
  max-height:80vh;
  border:5px solid white;
  border-radius:10px;
}
#hometown-comparison .comparison-label{
  position:absolute;
  top:20px;
  color:white;
  font-size:1.2rem;
  font-weight:bold;
  text-shadow:0 2px 10px rgba(0,0,0,0.8);
}
#hometown-comparison .close-btn{
  position:absolute;
  top:20px;
  right:20px;
  width:50px;
  height:50px;
  background:rgba(255,255,255,0.2);
  border:2px solid white;
  border-radius:50%;
  color:white;
  font-size:1.5rem;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:background 0.3s;
}
#hometown-comparison .close-btn:hover{
  background:rgba(255,255,255,0.4);
}
</style>
</head>

<body>

<img id="web-frame" src="web frame.png">
<div id="window-noise"></div>
<div id="scanlines"></div>

<div id="chapter-label">CHAPTER 3</div>
<div id="music-player">
  <div id="music-player-title">ìŒì•… í”Œë ˆì´ì–´</div>
  <div id="music-player-content">
    <button id="music-toggle">ì¬ìƒ</button>
    <div id="volume-control">
      <span>ğŸ”Š</span>
      <input type="range" id="volume-slider" min="0" max="100" value="50">
    </div>
  </div>
</div>
<audio id="bgmusic" loop>
  <source src="bgmusic.mp3" type="audio/mpeg">
</audio>

<div id="help-button">?</div>

<div id="hometown-fullscreen"></div>

<div id="blue-filter"></div>

<div id="library-scene">
  <!-- í´ë¦­ ê°€ëŠ¥í•œ í•«ìŠ¤íŒŸ -->
  <div class="hotspot" id="hot-wall"></div>
  <div class="hotspot" id="hot-tree"></div>
  <div class="hotspot" id="hot-shelf"></div>
  <div class="hotspot" id="hot-book"></div>
</div>

<!-- ê³ í–¥ ì˜¤ë²„ë ˆì´ -->
<div id="hometown-overlay">
  <img id="hometown-image">
</div>

<div id="speaker-label">YOU</div>
<div id="subtitle-box">
  <div id="subtitle-text"></div>
</div>

<div id="hint">ê³ í–¥ê³¼ ë¹„ìŠ·í•œ ë¶€ë¶„ì„ í´ë¦­í•´ë³´ì.</div>
<div id="cursor-dot"></div>
<div id="home-container"></div>

<!-- íŒì—… -->
<img id="popup-image">
<div id="popup"></div>

<!-- ê³ í–¥ ë¹„êµ í™”ë©´ -->
<div id="hometown-comparison">
  <div style="position:relative; text-align:center;">
    <div class="comparison-label" style="left:50%; transform:translateX(-50%);">ê³ í–¥</div>
    <img class="comparison-image" id="hometown-img" src="hometown.png" alt="ê³ í–¥">
  </div>
  <div style="position:relative; text-align:center;">
    <div class="comparison-label" style="right:50%; transform:translateX(50%);">ì§€ê¸ˆ ì´ì‚¬ì˜¨ ê³³</div>
    <img class="comparison-image" id="current-img" src="newlibrary.png" alt="í˜„ì¬ ë„ì„œê´€">
  </div>
  <div class="close-btn">Ã—</div>
</div>

<script>
const subtitleText = document.getElementById("subtitle-text");
const subtitleBox = document.getElementById("subtitle-box");
const speakerLabel = document.getElementById("speaker-label");
const cursor = document.getElementById("cursor-dot");
const homeContainer = document.getElementById("home-container");
const bgmusic = document.getElementById("bgmusic");
const musicToggle = document.getElementById("music-toggle");
const volumeSlider = document.getElementById("volume-slider");

// ìŒì•… í”Œë ˆì´ì–´ ì œì–´
musicToggle.addEventListener("click", () => {
  if(bgmusic.paused){
    bgmusic.play();
    musicToggle.textContent = "ì •ì§€";
  }else{
    bgmusic.pause();
    musicToggle.textContent = "ì¬ìƒ";
  }
});

volumeSlider.addEventListener("input", (e) => {
  bgmusic.volume = e.target.value / 100;
});
const hometownFullscreen = document.getElementById("hometown-fullscreen");
const libraryScene = document.getElementById("library-scene");
const hint = document.getElementById("hint");

// ì»¤ì„œ
document.addEventListener("mousemove", e => {
  cursor.style.left = e.clientX + "px";
  cursor.style.top = e.clientY + "px";
  
  // ì§‘ ì´ë¯¸ì§€ ìƒì„±
  const homeImgs = ['home2.png', 'home.png'];
  const now = Date.now();
  if(now - (lastCreateTime || 0) > 50){
    const img = document.createElement('img');
    img.src = homeImgs[Math.floor(Math.random() * homeImgs.length)];
    img.className = 'home';
    img.style.left = e.clientX + 'px';
    img.style.top = e.clientY + 'px';
    
    if(Math.random() > 0.5){
      img.style.width = '80px';
      img.style.opacity = '0.6';
      img.style.filter = 'blur(1.5px)';
    }
    
    homeContainer.appendChild(img);
    
    setTimeout(() => {
      img.style.opacity = 0;
      setTimeout(() => img.remove(), 500);
    }, 800);
    
    lastCreateTime = now;
  }
});

let lastCreateTime = 0;

// ë©”ì‹œì§€ ìˆœì„œ
const messages = [
  "ì£¼ë¯¼ ë¶„ ì¶”ì²œìœ¼ë¡œ ì–´ì©Œë‹¤ê°€ ë„ì„œê´€ê¹Œì§€ ì™€ë²„ë ¸ë„¤. ë¹¨ë¦¬ ì§‘ì— ê°€ì•¼í• í…ë° ë‚´ê°€ ë­í•˜ëŠ” ê±°ëŒ...",
  "ê·¸ë˜ë„ ì´ì™• ì˜¨ ê±° êµ¬ê²½ì´ë¼ë„ í•´ë³´ì.",
  "ì—‡, ì—¬ê¸° ë„ì„œê´€ ê³ í–¥ì— ìˆë˜ ê³³ì´ë‘ ë¹„ìŠ·í•œë°..?"
];

let currentMessageIndex = 0;
let isTyping = false;
let typingTimeout = null;
let sceneState = 0; // 0: ì´ˆê¸° ë©”ì‹œì§€, 1: hometown.png í‘œì‹œ, 2: library scene í™œì„±í™”

// íƒ€ì´í•‘ íš¨ê³¼ í•¨ìˆ˜
function typeText(text, callback){
  if(isTyping) return;
  isTyping = true;
  
  subtitleText.innerHTML = "";
  let charIndex = 0;
  
  function typeChar(){
    if(charIndex < text.length){
      subtitleText.innerHTML = text.substring(0, charIndex + 1) + '<span id="typing-cursor"></span>';
      charIndex++;
      typingTimeout = setTimeout(typeChar, 50);
    } else {
      subtitleText.innerHTML = text;
      isTyping = false;
      if(callback) callback();
    }
  }
  
  typeChar();
}

// ì²« ë©”ì‹œì§€ í‘œì‹œ
setTimeout(() => {
  speakerLabel.classList.add("show");
  subtitleBox.classList.add("show");
  typeText(messages[0]);
}, 500);

// í´ë¦­í•˜ë©´ ë‹¤ìŒ ë©”ì‹œì§€ë¡œ ë³€ê²½
subtitleBox.addEventListener("click", () => {
  if(isTyping){
    // íƒ€ì´í•‘ ì¤‘ì´ë©´ ì¦‰ì‹œ ì™„ì„±
    clearTimeout(typingTimeout);
    subtitleText.innerHTML = messages[currentMessageIndex];
    isTyping = false;
    return;
  }
  
  currentMessageIndex++;
  
  if(currentMessageIndex === 1){
    // ë‘ ë²ˆì§¸ ë©”ì‹œì§€
    typeText(messages[1], () => {
      // ë©”ì‹œì§€ ì™„ì„± í›„ ì ì‹œ ëŒ€ê¸°
    });
  } else if(currentMessageIndex === 2){
    // ë‘ ë²ˆì§¸ ë©”ì‹œì§€ í›„ í…ìŠ¤íŠ¸ ë°•ìŠ¤ ì‚¬ë¼ì§
    setTimeout(() => {
      subtitleBox.classList.remove("show");
      speakerLabel.classList.remove("show");
      
      // hometown.png ê¹œë¹¡ê±°ë¦¬ë©´ì„œ ë‚˜íƒ€ë‚¨
      setTimeout(() => {
        hometownFullscreen.classList.add("show");
        hometownFullscreen.classList.add("flicker");
        
        setTimeout(() => {
          hometownFullscreen.classList.remove("flicker");
          
          // ë‹¤ì‹œ í…ìŠ¤íŠ¸ ë°•ìŠ¤ ë‚˜íƒ€ë‚¨
          setTimeout(() => {
            subtitleBox.classList.add("show");
            typeText(messages[2], () => {
              // ë©”ì‹œì§€ ì™„ì„± í›„ í…ìŠ¤íŠ¸ ë°•ìŠ¤ ì‚¬ë¼ì§
              setTimeout(() => {
                subtitleBox.classList.remove("show");
                speakerLabel.classList.remove("show");
                
                // newlibrary.pngë¡œ ë°°ê²½ ë³€ê²½
                setTimeout(() => {
                  body.style.background = "url('newlibrary.png') center/cover no-repeat";
                  hometownFullscreen.classList.remove("show");
                  libraryScene.classList.add("show");
                  
                  // ê°ì²´ë“¤ í‘œì‹œ
                  const objs = document.querySelectorAll(".obj");
                  objs.forEach((obj, index) => {
                    setTimeout(() => {
                      obj.classList.add("show");
                    }, index * 200);
                  });
                  
                  // "ê³ í–¥ê³¼ ìœ ì‚¬í•œ ê²ƒë“¤ì„ í´ë¦­í•´ë³´ì„¸ìš”." ë¬¸êµ¬ í‘œì‹œ (ì •ì¤‘ì•™)
                  hint.textContent = "ê³ í–¥ê³¼ ìœ ì‚¬í•œ ê²ƒë“¤ì„ í´ë¦­í•´ë³´ì„¸ìš”.";
                  hint.classList.add("show");
                  
                  // 3ì´ˆ í›„ ìë™ìœ¼ë¡œ ì‚¬ë¼ì§
                  setTimeout(() => {
                    hint.classList.remove("show");
                  }, 3000);
                  
                  // ê°ì²´ ìƒí˜¸ì‘ìš© í™œì„±í™”
                  setupObjectInteraction();
                }, 1000);
              }, 2000);
            });
          }, 500);
        }, 2000);
      }, 500);
    }, 1000);
  }
});

const body = document.body;

// íŒì—… í•¨ìˆ˜
const popup = document.getElementById("popup");
const popupImg = document.getElementById("popup-image");

function showPopup(text, img){
  popup.style.display = "block";
  popup.innerHTML = text;
  if(img){
    popupImg.src = img;
    popupImg.style.display = "block";
  } else {
    popupImg.style.display = "none";
  }
}

function hidePopup(){
  popup.style.display = "none";
  popupImg.style.display = "none";
}

// ê°ì²´ ìƒí˜¸ì‘ìš© ì„¤ì •
let viewedItems = {
  wall: false,
  tree: false,
  bookcase: false,
  book: false
};

function checkAllItemsViewed(){
  if(viewedItems.wall && viewedItems.tree && viewedItems.bookcase && viewedItems.book){
    // ëª¨ë“  ì•„ì´í…œì„ ë³¸ ê²½ìš°
    setTimeout(() => {
      hidePopup();
      setTimeout(() => {
        subtitleBox.classList.add("show");
        typeText("ì—¬ê¸°ë„ ë‚˜ì˜ì§€ ì•Šë„¤? ì˜›ë‚  ìƒê°ë„ ë‚˜ê³  ë§ì´ì•¼.", () => {
          // íƒ€ì´í•‘ ì™„ë£Œ í›„ í´ë¦­í•˜ë©´ doors.htmlë¡œ ì´ë™
          subtitleBox.addEventListener("click", function finalClick(){
            if(isTyping){
              clearTimeout(typingTimeout);
              subtitleText.innerHTML = "ì—¬ê¸°ë„ ë‚˜ì˜ì§€ ì•Šë„¤? ì˜›ë‚  ìƒê°ë„ ë‚˜ê³  ë§ì´ì•¼.";
              isTyping = false;
              return;
            }
            subtitleBox.style.opacity = "0";
            setTimeout(() => {
              location.href = "doors.html";
            }, 500);
          }, {once: true});
        });
      }, 1500);
    }, 1000);
  }
}

function setupObjectInteraction(){
  // í•«ìŠ¤íŒŸ í´ë¦­ ì´ë²¤íŠ¸
  document.getElementById("hot-wall").onclick = (e) => {
    e.stopPropagation();
    if(!viewedItems.wall){
      viewedItems.wall = true;
      showPopup("ì™€ ì—¬ê¸° ë²½ì§€ë‘ ê³ í–¥ì— ìˆë˜ ë²½ì§€ë‘ ë¹„ìŠ·í•´. ì¢‹ì•„í–ˆë˜ ë²½ì§€ì˜€ëŠ”ë°...<br>ë˜ ë³¼ ìˆ˜ ìˆì–´ì„œ ë‹¤í–‰ì´ë‹¤.", "wall.png");
      checkAllItemsViewed();
    } else {
      showPopup("ì™€ ì—¬ê¸° ë²½ì§€ë‘ ê³ í–¥ì— ìˆë˜ ë²½ì§€ë‘ ë¹„ìŠ·í•´. ì¢‹ì•„í–ˆë˜ ë²½ì§€ì˜€ëŠ”ë°...<br>ë˜ ë³¼ ìˆ˜ ìˆì–´ì„œ ë‹¤í–‰ì´ë‹¤.", "wall.png");
    }
  };
  
  document.getElementById("hot-tree").onclick = (e) => {
    e.stopPropagation();
    if(!viewedItems.tree){
      viewedItems.tree = true;
      showPopup("ê³ í–¥ì— ìˆë˜ ë‚˜ë¬´ ì¸í…Œë¦¬ì–´ê°€ ìœ ì¼í•œ ê²ƒì´ë¼ê³  ìƒê°í–ˆëŠ”ë°..<br>ì—¬ê¸°ë„ ìˆëŠ” ê±°ì˜€êµ¬ë‚˜. ìì£¼ ë“¤ëŸ¬ë„ ë˜ê² ë‹¤.", "tree.png");
      checkAllItemsViewed();
    } else {
      showPopup("ê³ í–¥ì— ìˆë˜ ë‚˜ë¬´ ì¸í…Œë¦¬ì–´ê°€ ìœ ì¼í•œ ê²ƒì´ë¼ê³  ìƒê°í–ˆëŠ”ë°..<br>ì—¬ê¸°ë„ ìˆëŠ” ê±°ì˜€êµ¬ë‚˜. ìì£¼ ë“¤ëŸ¬ë„ ë˜ê² ë‹¤.", "tree.png");
    }
  };
  
  document.getElementById("hot-shelf").onclick = (e) => {
    e.stopPropagation();
    if(!viewedItems.bookcase){
      viewedItems.bookcase = true;
      showPopup("ì—¬ê¸°ë„ ëª©ì¬ ì±…ì¥ì´ ìˆêµ¬ë‚˜.<br>ëª©ì¬ê°€êµ¬ê°€ ì£¼ëŠ” í¸ì•ˆí•œ ë¶„ìœ„ê¸°ë„ ì˜¤ëœë§Œì´ë„¤.", "bookcase.png");
      checkAllItemsViewed();
    } else {
      showPopup("ì—¬ê¸°ë„ ëª©ì¬ ì±…ì¥ì´ ìˆêµ¬ë‚˜.<br>ëª©ì¬ê°€êµ¬ê°€ ì£¼ëŠ” í¸ì•ˆí•œ ë¶„ìœ„ê¸°ë„ ì˜¤ëœë§Œì´ë„¤.", "bookcase.png");
    }
  };
  
  document.getElementById("hot-book").onclick = (e) => {
    e.stopPropagation();
    if(!viewedItems.book){
      viewedItems.book = true;
      showPopup("ì–´ë¦´ ë•Œ ìì£¼ ì½ë˜ ì±…ì¸ë° ì—¬ê¸°ì—ë„ ìˆë„¤.", "book.png");
      checkAllItemsViewed();
    } else {
      showPopup("ì–´ë¦´ ë•Œ ìì£¼ ì½ë˜ ì±…ì¸ë° ì—¬ê¸°ì—ë„ ìˆë„¤.", "book.png");
    }
  };
  
  // ë¬¼ìŒí‘œ ë²„íŠ¼ í‘œì‹œ
  const helpButton = document.getElementById("help-button");
  helpButton.classList.add("show");
  
  // ë¬¼ìŒí‘œ ë²„íŠ¼ í´ë¦­ â†’ ì•ˆë‚´ ë¬¸êµ¬ í‘œì‹œ
  helpButton.onclick = (e) => {
    e.stopPropagation();
    hint.textContent = "ë²½ì§€ì™€ ë‚˜ë¬´ ì¸í…Œë¦¬ì–´, ê·¸ë¦¬ê³  ë‚˜ë¬´ ì±…ì¥ê³¼ ì–´ë¦´ ë•Œ ìì£¼ ì½ë˜ ì±…ì„ ì°¾ì•„ë³´ì.";
    hint.classList.add("bottom-center");
    hint.classList.add("show");
    
    // 5ì´ˆ í›„ ìë™ìœ¼ë¡œ ì‚¬ë¼ì§
    setTimeout(() => {
      hint.classList.remove("show");
      setTimeout(() => {
        hint.classList.remove("bottom-center");
      }, 300);
    }, 5000);
  };
  
  // ê³ í–¥ ë¹„êµ í™”ë©´ ë‹«ê¸°
  const closeBtn = document.querySelector("#hometown-comparison .close-btn");
  closeBtn.onclick = (e) => {
    e.stopPropagation();
    document.getElementById("hometown-comparison").classList.remove("show");
  };
  
  // ê³ í–¥ ë¹„êµ í™”ë©´ ë°°ê²½ í´ë¦­ â†’ ë‹«ê¸°
  document.getElementById("hometown-comparison").addEventListener("click", (e) => {
    if(e.target.id === "hometown-comparison"){
      e.target.classList.remove("show");
    }
  });
  
  // íŒì—… ì™¸ë¶€ í´ë¦­ â†’ ë‹«ê¸°
  document.addEventListener("click", (e) => {
    if(e.target.classList.contains("hotspot")) return;
    if(e.target === popupImg || e.target.closest("#popup")) return;
    if(e.target === helpButton || e.target.closest("#help-button")) return;
    hidePopup();
  });
}
</script>

</body>
</html>
