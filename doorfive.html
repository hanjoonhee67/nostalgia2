<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>결말</title>
<link href="https://fonts.googleapis.com/css2?family=Orbit:wght@400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  width:100vw;height:100vh;
  overflow:hidden;
  background:url('outside.png') center/cover no-repeat;
  font-family:"Orbit", monospace;
  cursor:none;
  position:relative;
  filter:brightness(0.5);
  transition:filter 3s ease-in;
}

body.bright{
  filter:brightness(1);
}

/* 챕터 표시 */
#chapter-label{
  position:fixed;
  top:30px;
  left:50%;
  transform:translateX(-50%);
  color:white;
  font-size:1.2rem;
  font-weight:bold;
  font-family:"Orbit", sans-serif;
  z-index:200;
  text-shadow:0 2px 10px rgba(0,0,0,0.5);
  letter-spacing:3px;
}

/* 프레임 이미지 */
#web-frame{
  position:fixed;
  inset:0;
  width:100vw;
  height:100vh;
  object-fit:cover;
  z-index:9999;
  pointer-events:none;
}

/* 윈도우 노이즈 효과 */
#window-noise{
  position:fixed;
  inset:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity:0.15;
  pointer-events:none;
  z-index:10000;
  mix-blend-mode:overlay;
  animation:noiseFlicker 0.1s infinite;
}

@keyframes noiseFlicker{
  0%,100%{opacity:0.1;}
  50%{opacity:0.2;}
}

/* 스캔라인 효과 */
#scanlines{
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    0deg,
    transparent 0px,
    transparent 2px,
    rgba(0,0,0,0.1) 2px,
    rgba(0,0,0,0.1) 4px
  );
  pointer-events:none;
  z-index:10001;
}

/* 검은 오버레이 - 눈을 뜨는 것처럼 페이드아웃 */
#black-overlay{
  position:fixed;
  inset:0;
  background:#000;
  z-index:1000;
  pointer-events:none;
  animation:fadeOutEyes 2s ease-out forwards;
}

@keyframes fadeOutEyes{
  0%{opacity:1;}
  100%{opacity:0;}
}

/* 파란 Error 화면 오버레이 */
#error-overlay{
  position:fixed;
  inset:0;
  background:#0000aa;
  opacity:0.4;
  z-index:1;
  pointer-events:none;
  transition:opacity 0.5s;
}

/* 스피커 라벨 */
#speaker-label{
  position:fixed;
  bottom:210px;
  left:50%;
  transform:translateX(-50%);
  margin-left:-280px;
  background:rgba(0,0,100,0.85);
  color:white;
  padding:8px 16px;
  border-radius:8px;
  font-size:0.9rem;
  font-weight:bold;
  text-transform:uppercase;
  z-index:100;
  pointer-events:none;
  font-family:"Orbit", sans-serif;
  opacity:0;
  transition:opacity 0.3s;
}

#speaker-label.show{opacity:1;}

/* 자막바 */
#subtitle-box{
  position:fixed;
  bottom:90px;
  left:50%;
  transform:translateX(-50%);
  width:600px;
  max-width:90%;
  background:rgba(0,0,0,0.6);
  padding:20px 30px;
  z-index:100;
  cursor:pointer;
  transition:background 0.3s;
  min-height:80px;
  display:flex;
  align-items:center;
  border-radius:10px;
  backdrop-filter:blur(5px);
  opacity:0;
  pointer-events:none;
}

#subtitle-box.show{
  opacity:1;
  pointer-events:auto;
}

#subtitle-box:hover{
  background:rgba(0,0,0,0.75);
}

#subtitle-text{
  color:white;
  font-size:1.1rem;
  line-height:1.6;
  font-family:"Orbit", sans-serif;
  width:100%;
  max-width:90%;
}

/* 타이핑 커서 */
#typing-cursor{
  display:inline-block;
  width:2px;
  height:1.2em;
  background:white;
  margin-left:4px;
  animation:blinkCursor 1s infinite;
  vertical-align:middle;
}

@keyframes blinkCursor{
  0%,50%{opacity:1;}
  51%,100%{opacity:0;}
}

/* 엔딩 크레딧 */
#ending-credits{
  position:fixed;
  inset:0;
  background:rgba(255,255,255,0.95);
  z-index:200;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity 2s;
}

#ending-credits.show{
  opacity:1;
  pointer-events:auto;
}

#credits-content{
  text-align:center;
  color:#333;
  font-family:"Orbit", sans-serif;
  transform:translateY(100vh);
  animation:scrollUp 15s linear forwards;
}

@keyframes scrollUp{
  0%{
    transform:translateY(100vh);
  }
  100%{
    transform:translateY(-100vh);
  }
}

#credits-content h1{
  font-size:3rem;
  margin-bottom:50px;
  color:#667eea;
}

#credits-content h2{
  font-size:2rem;
  margin:30px 0;
  color:#333;
}

#credits-content p{
  font-size:1.5rem;
  margin:20px 0;
  line-height:2;
}

/* 커서 */
#cursor-dot{
  position:fixed;
  width:14px;height:14px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,0.9);
  transform:translate(-50%,-50%);
  pointer-events:none;
  z-index:9999;
}
</style>
</head>
<body>

<img id="web-frame" src="web frame.png" alt="frame">
<div id="window-noise"></div>
<div id="scanlines"></div>
<div id="chapter-label">CHAPTER 5</div>
<div id="black-overlay"></div>
<div id="error-overlay"></div>

<div id="speaker-label">YOU</div>
<div id="subtitle-box">
  <div id="subtitle-text"></div>
</div>

<div id="ending-credits">
  <div id="credits-content">
    <h1>노스탤지어</h1>
    <h2>끝</h2>
    <p>감사합니다</p>
  </div>
</div>

<div id="cursor-dot"></div>

<script>
const subtitleBox = document.getElementById("subtitle-box");
const subtitleText = document.getElementById("subtitle-text");
const speakerLabel = document.getElementById("speaker-label");
const endingCredits = document.getElementById("ending-credits");
const cursor = document.getElementById("cursor-dot");

// 메시지 순서
const messages = [
  "다들 참 다정하네.",
  "고향과 비슷한 곳도 있고 말이야.",
  "어쩌면...",
  "내가 너무 좁게만 생각했을지도 몰라.",
  "여기도 나쁘지 않은 곳인걸..",
  "이젠 고향에 돌아가지 않아도 될 것 같아."
];

let currentMessageIndex = 0;
let isTyping = false;
let typingTimeout = null;

// 타이핑 효과
function typeText(text, callback){
  if(isTyping) return;
  isTyping = true;
  
  subtitleText.innerHTML = "";
  let charIndex = 0;
  
  function typeChar(){
    if(charIndex < text.length){
      subtitleText.innerHTML = text.substring(0, charIndex + 1) + '<span id="typing-cursor"></span>';
      charIndex++;
      typingTimeout = setTimeout(typeChar, 50);
    } else {
      subtitleText.innerHTML = text;
      isTyping = false;
      if(callback) callback();
    }
  }
  
  typeChar();
}

// 커서
document.addEventListener("mousemove", e => {
  cursor.style.left = e.clientX + "px";
  cursor.style.top = e.clientY + "px";
});

// 첫 메시지 표시
setTimeout(() => {
  speakerLabel.classList.add("show");
  subtitleBox.classList.add("show");
  typeText(messages[0]);
}, 2100); // 검은 오버레이가 사라진 후

// 자막바 클릭 이벤트
subtitleBox.addEventListener("click", () => {
  if(isTyping){
    // 타이핑 중이면 즉시 완성
    clearTimeout(typingTimeout);
    subtitleText.innerHTML = messages[currentMessageIndex];
    isTyping = false;
    return;
  }
  
  currentMessageIndex++;
  
  if(currentMessageIndex < messages.length){
    // 다음 메시지 타이핑
    typeText(messages[currentMessageIndex]);
  } else {
    // 마지막 메시지 후 화면 밝아지고 크레딧
    subtitleBox.style.opacity = "0";
    speakerLabel.style.opacity = "0";
    errorOverlay.style.opacity = "0";
    
    // 화면 밝아지기
    document.body.classList.add("bright");
    
    setTimeout(() => {
      // 크레딧 표시
      endingCredits.classList.add("show");
    }, 2000);
  }
});
</script>

</body>
</html>
